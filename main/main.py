import uasyncio as asyncioimport pkg_resourcesimport picowebimport utemplateimport _threadfrom main import wattmeterfrom main import wifiManagerimport timeimport jsonclass mainRoutine:          def __init__(self,wlan):        self.wifiManager = wlan        self.ipAddress = self.wifiManager.getIp()        self.port = 8000        self.wattmeter = wattmeter.Wattmeter()        self.ROUTES = [        ("/", self.main),         ("/datatable", self.dataTable),        ("/updateWificlient",self.updateWificlient),        ("/updateData", self.updateData),         ("/settings", self.settings),        ("/getEspID", self.getEspID)        ]        self.app = picoweb.WebApp(None, self.ROUTES)        def main(self,req, resp):        yield from picoweb.start_response(resp)        yield from self.app.render_template(resp,"main.html",(req,))     def settings(self,req, resp):            yield from picoweb.start_response(resp)        yield from self.app.render_template(resp, "settings.html", (req,))            def updateData(self,req, resp):        datalayer = self.wattmeter.datalayer.data        yield from picoweb.jsonify(resp,datalayer)    def updateWificlient(self,req, resp):        if req.method == "POST":            datalayer = {}            yield from req.read_form_data()            for i in req.form:                 i = json.loads(i)                 print(i["ssid"],i["password"])                   datalayer = self.wifiManager.handle_configure(i["ssid"],i["password"])                self.ipAddress=self.wifiManager.getIp()[0]                datalayer = {"process":datalayer,"ip":self.ipAddress}                        print("datalayer: ",datalayer)                yield from picoweb.jsonify(resp,datalayer)                        else:            datalayer = self.wifiManager.getSSID()            yield from picoweb.jsonify(resp,datalayer)        def dataTable(self,req, resp):        yield from picoweb.start_response(resp)        yield from self.app.render_template(resp, "datatable.html", (req,))    def getEspID(self,req,resp):            print("Tisknu")            print(req)            datalayer = {"ID":"ESP1"}            yield from picoweb.jsonify(resp,datalayer)              def threadWattmeter(self):        while True:            self.wattmeter.updateData()            time.sleep(1)                def run(self):        _thread.start_new_thread(self.threadWattmeter, ())        print("Start webserver App")        self.app.run(debug=True, host=self.ipAddress,port=self.port) #startPicoweb("static")